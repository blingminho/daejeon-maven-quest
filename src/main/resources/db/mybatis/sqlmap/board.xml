<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">
	
	<!-- 해당 게시판의 해당 페이지의 모든 글을 출력 -->
	<select id="getBoardPagingList" parameterType="Map" resultType="BoardVO">
	<![CDATA[
		SELECT X.*
		FROM (
		    SELECT ROWNUM AS rnum, A.*
		    FROM (
		        SELECT LEVEL, BOARD.*
		        FROM BOARD 
		        WHERE BOARD_TBOARD_SEQ = #{board_tboard_seq} 
		        START WITH BOARD_P_SEQ IS NULL 
		        CONNECT BY PRIOR BOARD_SEQ = BOARD_P_SEQ
		        ORDER siblings BY BOARD_REG_DT DESC) A
		        WHERE ROWNUM <= #{pageNum}*10) X
		WHERE X.rnum >= (#{pageNum}-1)*10 + 1
	]]>
	</select>

	<!-- 해당 게시판의 글 수를 가져옴 -->
	<select id="getBoardListCount" parameterType="String" resultType="int">
		SELECT COUNT(*)
		FROM BOARD
		WHERE BOARD_TBOARD_SEQ = #{board_tboard_seq}
	</select>

</mapper>